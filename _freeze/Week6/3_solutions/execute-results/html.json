{
  "hash": "382650a8698fc7fa385500f898d1841c",
  "result": {
    "engine": "knitr",
    "markdown": "## Solutions\n\n:::{.callout-tip}\nHover over the code and copy the content by clicking on the clipboard icon on the top right. You can now paste this into an R-Script.\n:::\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```{.sourceCode .r}\n# task_1.R\n################################################################################\n\n\ncrop_fanel <- read_sf(\"datasets/Feldaufnahmen_Fanel.gpkg\")\n\nhead(crop_fanel)\n\nsummary(crop_fanel)\n\nunique(crop_fanel$Frucht)\n\nst_crs(crop_fanel)\n\n\n\nlibrary(\"ggplot2\")\n\nggplot(crop_fanel) +\n  geom_sf(aes(fill = Frucht))\n\n\n\n\n# task_2.R\n################################################################################\n\n\n\nlibrary(\"dplyr\")\nlibrary(\"lubridate\")\n\nwildschwein_summer <- wildschwein_BE |>\n  filter(month(DatetimeUTC) %in% 5:6)\n\nwildschwein_summer <- st_join(wildschwein_summer, crop_fanel)\n\nwildschwein_summer\n\nggplot(crop_fanel) +\n  geom_sf(aes(fill = Frucht)) +\n  geom_sf(data = wildschwein_summer)\n\n\n\n\n# task_3.R\n################################################################################\n\n\nlibrary(\"forcats\")\n\nwildschwein_smry <- wildschwein_summer |>\n  st_set_geometry(NULL) |>\n  mutate(\n    hour = hour(round_date(DatetimeUTC, \"hour\")),\n    Frucht = ifelse(is.na(Frucht), \"other\", Frucht),\n    Frucht = fct_lump(Frucht, 5, other_level = \"other\"),\n  ) |>\n  count(TierName, hour, Frucht) |>\n  group_by(TierName, hour) |>\n  mutate(perc = n / sum(n)) |>\n  ungroup() |>\n  mutate(\n    Frucht = fct_reorder(Frucht, n, sum, desc = TRUE)\n  )\n\nggplot(wildschwein_smry, aes(hour, perc, fill = Frucht)) +\n  geom_col(width = 1) +\n  scale_fill_brewer(palette = \"Set2\") +\n  scale_y_continuous(name = \"Percentage\", labels = scales::percent_format()) +\n  scale_x_continuous(name = \"Time (rounded to the nearest hour)\") +\n  facet_wrap(~TierName) +\n  theme_light() +\n  labs(\n    title = \"Percentages of samples in a given crop per hour\",\n    subtitle = \"Only showing the most common categories\"\n  )\n\n\nwildschwein_smry |>\n  filter(TierName == \"Rosa\") |>\n  ggplot(aes(hour, perc, fill = Frucht)) +\n  geom_col(width = 1, colour = \"black\") +\n  scale_fill_brewer(palette = \"Set2\") +\n  scale_x_continuous(breaks = seq(0,23)) +\n  coord_polar(start = -pi/24) +\n  labs(\n    title = \"Percentages of samples in a given crop per hour\",\n    subtitle = \"Only showing the most common categories for 'Rosa'\"\n  ) + \n  theme_light() +\n  theme(axis.text.y = element_blank(),axis.title = element_blank())\n\n\n\n\n\n\n# task_4.R\n################################################################################\n\n\nlibrary(\"terra\")\nlibrary(\"tmap\")\n\nveg_height <- rast(\"datasets/vegetationshoehe_LFI.tif\")\n\ntm_shape(veg_height) +\n  tm_raster(palette = \"viridis\", style = \"cont\", legend.is.portrait = FALSE) +\n  tm_layout(legend.outside = TRUE, legend.outside.position = \"bottom\", frame = FALSE)\n\n\n\n\n# task_5.R\n################################################################################\n\n\nveg_height_df <- terra::extract(veg_height, st_coordinates(wildschwein_BE))\n\nwildschwein_BE <- cbind(wildschwein_BE, veg_height_df)\n\nwildschwein_BE\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}